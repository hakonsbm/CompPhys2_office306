\subsection{Atoms and Molecules}
	%General atoms stuff that applies to all the different atoms
	The dimensionless hamiltonian for the case of electrons around a nucleus is given by 

	\begin{align}
		\hat{H} &= \sum_{i = 1}^N - \frac{\nabla^2_i}{2} - \frac{Z}{r_i} + \sum_{i < j}\frac{1}{r_{ij}} \label{eq:hamiltonian}
	\end{align}

	where \(r_i\) is the distance from electron \(i\) to the nucleus, \(Z\) is the nucleus charge, and \(r_{ij} = |\vb{r}_i - \vb{r}_j|\).
	The kinetic energy for electron \(i\) is represented by \( - \frac{\nabla^2_i}{2} \), \(- \frac{Z}{r_i}\) the potential energy with respect to the nucleus and \( \frac{1}{r_{ij}} \) the repulsive energy between the electrons \(i\) and \( j\).

	In the VMC calculation the local energy, \(E_L\) is a useful quantity and needs to be finite at all points to be normalizable. So by looking at the limits where the \(E_L\) diverges we can guess the form the wavefunctions should follow.

	\begin{align}
		E_L(r_i,r_{ij}) &= \frac{1}{\Psi_T} \hat{H} \Psi_T
	\end{align}

	In the cases where \(r_i \rightarrow 0\) or \( r_{ij} \rightarrow 0\) we need to make sure that the local energy does not diverge.


		\begin{align}
			\lim_{r_i\rightarrow 0} {E_L(r_i,r_{ij}) } &= \frac{1}{R_i(r_i)} \left( - \frac{1}{2}\pdv[2]{}{x_k} - \frac{Z}{r_i} \right) R_i(r_i) + G(r_i, r_{ij})
			\\
			\lim_{r_i\rightarrow 0} {E_L(r_i,r_{ij}) } &= \frac{1}{R_i(r_i)} \left( - \frac{1}{2}\pdv[2]{}{r_k} - \frac{1}{r_i}\pdv{}{r_i}	 -	 \frac{Z}{r_i} \right) R_i(r_i) + G(r_i, r_{ij})
			\intertext{Given a well behaved wavefunction \( \frac{1}{2}\pdv[2]{}{r_k} \) is finite.}
			\lim_{r_i\rightarrow 0} {E_L(r_i,r_{ij}) } &= 
			\frac{1}{R_i(r_i)} \left( - \frac{1}{r_i}\pdv{}{r_i}	 -	 \frac{Z}{r_i} \right) R_i(r_i)
		\end{align}

		This is finite given when the following differential equation is fulfilled.

		\begin{align}
			\frac{1}{R_i(r_i)} \pdv{}{r_i} R_i(r_i)	=  -Z  \qquad{ \text{ With solution }}  \qquad R_i(r_i) = A e^{-Z}
		\end{align}

		A similar calculation applies for \(r_{12} \rightarrow 0\) and a trialfunction of the form   \[\Psi_T(r_i,r_j,r_{ij}) = e^{ -\alpha \sum_{N}  r_i} \prod^N_{i < j}e^{\beta r_{ij}} = e^{ -\alpha \sum_{N}  r_i} \prod^N_{i < j}e^{\frac{a r_{ij}}{1 + \beta r_{ij}}} \] should fulfill the condition that the local energy is finite.
	\subsubsection{Hydrogenic wavefunctions}
		A hydrogen atom is analytically solvable and we have exact wavefunctions corresponding to the electron being in the different shells. When we are building atoms containing more electrons turning it into a many body problem we base our guess at the trialfunction on the solutions to the hydrogen atom. So we need the wavefunctions for the five lowest states to calculate up to the \(10\) electron big neon atom. The hydrogenic wavefunctions along with their gradients and laplacians is contained in \cref{tab:hydrogenicWavefunctions}. The radial distribution of the first three hydrogen orbitals, which our trialfunctions is based on, is depicted in \cref{fig:orbitals_radial}.


		\begin{table}
			\begin{center}
				\begin{tabular}{| c | c | c | c |}
				\bottomrule
				& \( \psi_i\)	& \( \nabla\psi_i \) & \( \nabla^2\psi_i \)
				\\ \hline
					\(\psi_{1S}\)
					&
					\( e^{- \alpha ri} \)
					&
					\( - \frac{\alpha}{r_{i}} \vb{r_i}e^{- \alpha r_{i}} \)
					&
					\(\frac{\alpha}{r_{i}} \left(\alpha r_{i} - 2\right) e^{- \alpha r_{i}} \)
				\\	\hline
					\(\psi_{2S}\)
					&
					\( \left(- \frac{\alpha r_{i}}{2} + 1\right) e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( \frac{\alpha }{4 r_{i}} \left(\alpha r_{i} - 4\right) \vb{r_i} e^{- \frac{\alpha r_{i}}{2}}\)
					&
					\( - \frac{\alpha }{8 r_{i}} \left(\alpha^{2} r_{i}^{2} - 10 \alpha r_{i} + 16\right) e^{- \frac{\alpha r_{i}}{2}} \)
				\\	\hline
					\(\psi_{2Px}\)
					&
					\( \alpha x_{i} e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( - \frac{\alpha x_i}{2 r_{i}} \left(\alpha \vb{r_i} - 2 r_{i}\vu{i}\right) e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( \frac{\alpha^{2} x_{i}}{4 r_{i}} \left(\alpha r_{i} - 8\right) e^{- \frac{\alpha r_{i}}{2}} \)
				\\	\hline
					\(\psi_{2Py}\)
					&
					\( \alpha x_{i} e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( - \frac{\alpha y_i}{2 r_{i}} \left(\alpha \vb{r_i} - 2 r_{i}\vu{i}\right) e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( \frac{\alpha^{2} x_{i}}{4 r_{i}} \left(\alpha r_{i} - 8\right) e^{- \frac{\alpha r_{i}}{2}} \)
				\\	\hline
					\(\psi_{2Pz}\)
					&
					\( \alpha x_{i} e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( - \frac{\alpha z_i}{2 r_{i}} \left(\alpha \vb{r_i} - 2 r_{i}\vu{i}\right) e^{- \frac{\alpha r_{i}}{2}} \)
					&
					\( \frac{\alpha^{2} x_{i}}{4 r_{i}} \left(\alpha r_{i} - 8\right) e^{- \frac{\alpha r_{i}}{2}} \)
				\\ \toprule
				\end{tabular}
				\caption{The different hydrogenic wavefunctions along with the gradients and laplacians. The derivatives is computed in the program derivatives.py}
				\label{tab:hydrogenicWavefunctions}
			\end{center}
		\end{table}

		\begin{figure}
		\begin{tikzpicture}[domain=0:10, range = 0:6]
	    % \draw[very thin,color=gray] (-0.1,-1.1) grid (3.9,3.9);
		    \draw[->] (-0.2,0) -- (10,0) node[below] {$r$};
		    \draw[->] (0,0) -- (0,4) node[left] {$|R(r)|^2$};
		    % \draw[color=red] plot[id=x, samples = 100, domain = 0:3] function{175*x**2*exp(-x/0.2)} 
		   	\draw[color=red] plot[id=exp, samples = 100, domain = 0:5] function{6*x**2*(2*exp(-x))**2};
		    	\draw[color=red] (1.1,3.5) node {$\psi_{S1}$};
		    \draw[color=blue] plot[id=sin, samples = 100] function{6*x**2*(1/(2*sqrt(2))*(2-x)*exp(-x/2))**2}; 
		        \draw[color = blue] (6,1.4) node {$\psi_{S2}$};
		    \draw[color=green] plot[id=exp, samples = 100] function{6*x**2* ( 1/(2*sqrt(6)) * x  * exp(-x/2))**2} ;
		        \draw[color = green] (3.6,1.4) node {$\psi_{P2}$};
		\end{tikzpicture}
		\caption{The radial probability distribution of the first three orbitals of a hydrogen atom. The radial distribution functions is taken from \parencite{Introduction_Quantum_Pauling}}
		\label{fig:orbitals_radial}
		\end{figure}

	\subsubsection{Helium atom}
		We wanted to do our Variational Monte Carlo, VMC, computations on helium first since it was a simpler system that the larger atoms and molecules.	The hamiltonian for the helium atom is given by equation \eqref{eq:hamiltonian} and a trialfunction that fulfills the cusp conditions discussed earlier is

		\begin{align}
			\Psi_{T2}(\vb{r}_1, \vb{r}_2, \vb{r}_{12}) &=  e^{ -\alpha(r_1 + r_2)} e^{\frac{ r_{12}}{2(1 + \beta r_{12})}}
		\end{align}

		We have also done calculations for a simplified version of the trialfunction by taking out electron-electron interaction from the trialfunction so we end up with the trialfunction

		\begin{align}
			\Psi_{T1}(\vb{r}_1, \vb{r}_2) &=  e^{ -\alpha(r_1 + r_2)} 
		\end{align}

		We calculated the local energies for these two trialfunctions, \textbf{(NB!!!! Add link to localEnergy.py)}, and they are for \(\Psi_{T1} \) and \(\Psi_{T2}\).

		\begin{align}
			E_{L1} &= (\alpha - Z)\left( \frac{1}{r_2} + \frac{1}{r_2} \right) + \frac{1}{r_{12}} - \alpha ^2
			\\
			E_{L2} &= E_{L1} + \frac{1}{2\left(1+\beta r_{12}\right)} \left[ \frac{\alpha(r_1 + r_2)}{r_{12}}\left( 1 - \frac{\vb{r_1}\vb{r_2}}{r_1 r_2} \right)  -  \frac{1}{2\left(1+\beta r_{12}\right)} - \frac{2}{r_{12}} +  \frac{2\beta}{\left(1+\beta r_{12}\right)} \right]
		\end{align}


	\subsubsection{Beryllium atom}

		It is fairly simple to extend the calculational machinery of Variational
		Monte Carlo to other systems than the Helium atom. To show this we
		want to perform calculations on the beryllium atom. As beryllium has
		four electrons compared to the 2 of helium, we need to calculate a
		Slater determinant. Sticking to hydrogen-like wave functions,
		we can write the trial wave function for beryllium as
		\begin{equation}
			\psi_{T}({\bf r_{1}},{\bf r_{2}},{\bf r_{3}},{\bf r_{4}})=Det\left(\phi_{1}({\bf r_{1}}),\phi_{2}({\bf r_{2}}),\phi_{3}({\bf r_{3}}),\phi_{4}({\bf r_{4}})\right)\prod_{i<j}^{4}\exp{\left(\frac{a r_{ij}}{(1+\beta r_{ij})}\right)},
			\label{eq:BerylliumTrialFunction}
		\end{equation}
		where $Det$ is a Slater determinant and the single-particle wave
		functions are the hydrogen wave functions for the 1s and 2s orbitals.
		With the variational ansatz these are
		\begin{align}
			\phi_{1s}({\bf r_{i}})=e^{-\alpha r_{i}},
		\end{align}
		and
		\begin{align}
			\phi_{2s}({\bf r_{i}})=\left(1-\alpha r_{i}/2\right)e^{-\alpha r_{i}/2}.
		\end{align}
		The Slater determinant is calculated using these ansatzes, and can for Beryllium be written out as

		\begin{align}
			|D| &\propto 
			\left[ \psi_{1s}(\vb{r_1})\psi_{2s}(\vb{r_2}) -   \psi_{1s}(\vb{r_2})\psi_{2s}(\vb{r_1})  \right]
			\left[ \psi_{1s}(\vb{r_3})\psi_{2s}(\vb{r_4}) -   \psi_{1s}(\vb{r_4})\psi_{2s}(\vb{r_3})  
			\right]
		\end{align}

		Furthermore, for the Jastrow factor,
		\begin{align}
			\Psi_{C}=\prod_{i<j}g(r_{ij})=\exp{\sum_{i<j}\frac{ar_{ij}}{1+\beta r_{ij}}},
		\end{align}
		we need to take into account the spins of the electrons. We fix electrons
		1 and 2 to have spin up, and electron 3 and 4 to have spin down. This
		means that when the electrons have equal spins we get a factor
		\begin{align}
			a=\frac{1}{4},
		\end{align}
		and if they have opposite spins we get a factor
		\begin{align}
			a=\frac{1}{2}.
		\end{align}

	\subsubsection{Neon atom}

		Wishing to extend our variational Monte Carlo machinery further we implement Neon. Neon has ten electrons, so it is a big jump from Helium and Beryllium. Now we need better methods to handle the Slater determinant and is described in subsection \ref{sec:slaterdeterminant}. The trial wave function for Neon can be written as
		\begin{equation}
		   \psi_{T}({\bf r_1},{\bf r_2}, \dots,{\bf r_{10}}) =
		   Det\left(\phi_{1}({\bf r_1}),\phi_{2}({\bf r_2}),
		   \dots,\phi_{10}({\bf r_{10}})\right)
		   \prod_{i<j}^{10}\exp{\left(\frac{r_{ij}}{2(1+\beta r_{ij})}\right)},
		   \label{eq:NeonTrialFunction}
		\end{equation}
		Now we need to include the $2p$ wave function as well. It is given as
		\begin{equation}
			\phi_{2p}({\bf r_i}) = \alpha {\bf r_i}e^{-\alpha r_i/2}.
		\end{equation}
		where $ {r_i} = \sqrt{r_{i_x}^2+r_{i_y}^2+r_{i_z}^2}$.



	\subsubsection{Hydrogen molecule}
		The VMC machinery can also handle simple molecules with some modifications considering that we now have two nuclei. So we need a slightly different Hamiltonian, where we we need include a few more terms in the potential energy of the system. If we let \(\vb{R}\) be the vector between the nuclei we can write the positions, \(\vb{r_{ip1}}\), of electron \(i\) in relation to nucleus \(1\).

		\begin{align}
			\vb{r_{ip1}} = \vb{r_i} + \frac{\vb{R}}{2}
			\\
			\vb{r_{ip2}} = \vb{r_i} - \frac{\vb{R}}{2}
		\end{align}

		Then we add all the terms for the potential energy with the kinetic energy and get the Hamiltonian

		\begin{align}
			\hat{H} &= \sum_{i = 1}^2 - \frac{\nabla^2_i}{2} - \frac{Z_1}{r_{ip1}} - \frac{Z_2}{r_{ip2}} + \sum_{i < j}\frac{1}{r_{ij}} + \frac{Z_1Z_2}{|\vb{R|}} \label{eq:hamiltonianMolecule}
		\end{align}

		Here \(Z_1\) and \(Z_2\) is given by the charge of the respective nuclei. If we base our guess for the trialfunction on the assumption that the wavefunction for an electron should be a linear combination of the two hydrogenic wavefunctions around each nuclei. Disregarding factors, since they disappear in the VMC computation, and assuming symmetry about the nuclei we end up with

		\begin{align}
			\Psi_T(\vb{r_1}, \vb{r_2} , \vb{R} ) &= \psi(\vb{r_1} , \vb{R})\psi(\vb{r_2} , \vb{R}) \exp{ \frac{r_{12}}{2(1+\beta r_{12})} } \label{eq:H2Trialfunction}
		\end{align}

	\subsection{Calculating the Slater determinant}
		\label{sec:slaterdeterminant}
			To describe the wavefunction of multiple fermions we use a Slater
			determinant. The Slater determinant has the form
			\begin{align}
				\Phi(\mathbf{r}_{1},\mathbf{r}_{2},\mathbf{r}_{3},\mathbf{r}_{4},\alpha,\beta,\gamma,\delta)=\frac{1}{\sqrt{4!}}\left|\begin{array}{cccc}
				\psi_{100\uparrow}(\mathbf{r}_{1}) & \psi_{100\uparrow}(\mathbf{r}_{2}) & \psi_{100\uparrow}(\mathbf{r}_{3}) & \psi_{100\uparrow}(\mathbf{r}_{4})\\
				\psi_{100\downarrow}(\mathbf{r}_{1}) & \psi_{100\downarrow}(\mathbf{r}_{2}) & \psi_{100\downarrow}(\mathbf{r}_{3}) & \psi_{100\downarrow}(\mathbf{r}_{4})\\
				\psi_{200\uparrow}(\mathbf{r}_{1}) & \psi_{200\uparrow}(\mathbf{r}_{2}) & \psi_{200\uparrow}(\mathbf{r}_{3}) & \psi_{200\uparrow}(\mathbf{r}_{4})\\
				\psi_{200\downarrow}(\mathbf{r}_{1}) & \psi_{200\downarrow}(\mathbf{r}_{2}) & \psi_{200\downarrow}(\mathbf{r}_{3}) & \psi_{200\downarrow}(\mathbf{r}_{4})
				\end{array}\right|
			\end{align}
			for a four-fermionic system. Because the spatial wave functions for
			spin up and spin down states are equal, this Slater determinant equals
			zero. We can rewrite the Slater determinant as a product of two Slater
			determinants, one for spin up and one for spin down. This gives us
			\begin{eqnarray*}
				\Phi(\mathbf{r}_{1},\mathbf{r}_{2},,\mathbf{r}_{3},\mathbf{r}_{4},\alpha,\beta,\gamma,\delta) & = & \det\uparrow(1,2)\det\downarrow(3,4)-\det\uparrow(1,3)\det\downarrow(2,4)\\
		 		&  & -\det\uparrow(1,4)\det\downarrow(3,2)+\det\uparrow(2,3)\det\downarrow(1,4)\\
		 		&  & -\det\uparrow(2,4)\det\downarrow(1,3)+\det\uparrow(3,4)\det\downarrow(1,2)
			\end{eqnarray*}
			Here we have defined the Slater determinant for spin up as
			\begin{align}
				\det\uparrow(1,2)=\frac{1}{\sqrt{2}}\left|\begin{array}{cc}
				\psi_{100\uparrow}(\mathbf{r}_{1}) & \psi_{100\uparrow}(\mathbf{r}_{2})\\
				\psi_{200\uparrow}(\mathbf{r}_{1}) & \psi_{200\uparrow}(\mathbf{r}_{2})
				\end{array}\right|
			\end{align}
			and the Slater determinant for spin down as
			\begin{align}
				\det\downarrow(3,4)=\frac{1}{\sqrt{2}}\left|\begin{array}{cc}
				\psi_{100\downarrow}(\mathbf{r}_{3}) & \psi_{100\downarrow}(\mathbf{r}_{4})\\
				\psi_{200\downarrow}(\mathbf{r}_{3}) & \psi_{200\downarrow}(\mathbf{r}_{4})
				\end{array}\right|
			\end{align}
			And the total determinant is of course still zero.

			Further, it can be shown that for the variational energy we can approximate
			the Slater determinant as
			\begin{align}
				\Phi(\mathbf{r}_{1},\mathbf{r}_{2},\dots\mathbf{r}_{N})\propto\det\uparrow\det\downarrow
			\end{align}
			We now have the Slater determinant as a product of two determinants,
			one containing the electrons with only spin up, and one containing
			the electrons of spin down. This approach has certain limits as the
			ansatz isn't antisymmetric under the exchange of electrons with opposite
			spins, but it gives the same expectation value for the energy as the
			full Slater determinant as long as the Hamiltonian is spin independent.
			We thus avoid summing over spin variables.

			Now we have the Slater determinant written as a product of a determinant
			for spin up and a determinant for spin down. The next step is to invert
			the matrices using LU decomposition. We can thus rewrite a matrix
			$\hat{A}$ as a product of two matrices, $\hat{B}$ and $\hat{C}$
			\[
			\left(\begin{array}{cccc}
			a_{11} & a_{12} & a_{13} & a_{14}\\
			a_{21} & a_{22} & a_{23} & a_{24}\\
			a_{31} & a_{32} & a_{33} & a_{34}\\
			a_{41} & a_{42} & a_{43} & a_{44}
			\end{array}\right)=\left(\begin{array}{cccc}
			1 & 0 & 0 & 0\\
			b_{21} & 1 & 0 & 0\\
			b_{31} & b_{32} & 1 & 0\\
			b_{41} & b_{42} & b_{43} & 1
			\end{array}\right)\left(\begin{array}{cccc}
			c_{11} & c_{12} & c_{13} & c_{14}\\
			0 & c_{22} & c_{23} & c_{24}\\
			0 & 0 & c_{33} & c_{34}\\
			0 & 0 & 0 & c_{44}
			\end{array}\right)
			\]
			LU factorization exists for $\hat{A}$ if the determinant is nonzero.
			If $\hat{A}$ also is non-singular, then the LU factorization is unique
			and the determinant is given by
			\begin{align}
				\vert\hat{A}\vert=c_{11}c_{22}\dots c_{nn}
			\end{align}
			Using this we can calculate the spin up determinant, the spin down
			determinant, and by putting them together, the Slater determinant.
